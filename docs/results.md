# Results

## Introduction

In our application scenarios (XSS/SQLi detection), we give more weight to false negatives (resulting in low recall) with respect to false positives (resulting in low precision), since a non-detected attack can cause much more damage than a benign request detected as an attack.
For this reason, the main performance metric used in our empirical study is the F2-Score, referred to as F2 for simplicity, which gives double importance to recall than to precision: F2 = (5 * precision * recall) / (4 * precision + recall).
To mitigate a possible threat to the construct validity associated with the choice of F2-Score as the performance metric, we replicated all experiments using accuracy as an alternative performance metric. For space reasons, we could not report the results obtained with both metrics in the paper, so here, where we do not have space limitations you can find the results obtained with both metrics.

## RQ1
How helpful is RAG in generating
better security-critical functions? How does it perform
when combined with Few-shot examples?

### Accuracy XSS Detection


### F2-Score XSS Detection


### Accuracy SQLi Detection


### F2-Score SQLi Detection


## RQ2
Is the selection of
top_k functions via Self-Ranking an effective strategy for
enhancing the performance of security-critical functions?

### Top-k Accuracy XSS Detection


### Top-k F2-Score XSS Detection


### Top-k Accuracy SQLi Detection


### Top-k F2-Score SQLi Detection


## RQ3
Do the functions generated by LLMs, when assessed on an existing evaluation
dataset, demonstrate comparable performance to state-of-
the-art ML models trained specifically for the task?

### Comparison with SOTA (Accuracy)
In this section we select the $U^{best}$ and $top\_k$ functions based on the validation set ($val\_set$) using the Accuracy ($\mathcal{M} = Accuracy$). For XSS, the optimal configuration $U^{best}$ is $(Opus, 0.0, 6, F)$, while for SQLi, it is $(GPT-4, 0.0, 2, T)$. To establish a reference point, we use a baseline derived from the Basic Prompt, which lacks Few-shot examples and Retrieval-Augmented Generation (RAG).

The table below shows the results of our comparison. Our method achieves a substantial improvement of 21%pt for XSS and 18%pt for SQLi when compared to the baseline. However, there is a minor decrease in the Accuracy relative to SOTA models, with a reduction of 0.3 percentage points for XSS and 1.33 percentage points for SQLi. We believe that this small performance gap is justified, considering our method's training-free nature and its direct applicability to various tasks.
![screen](../tables_screenshot/rq3.png)


### Comparison with SOTA (F2-Score)
To compare ours with learning-based SOTA techniques, we select $U^{best}$ and $top\_k$ functions based on $val\_set$ using F2-Score ($\mathcal{M} = F_2$). For XSS, $U^{best}$ is $(GPT-4T, 0.0, 10, T)$, while for SQLi, it is $(GPT-4T, 0.0, 2, T)$. We establish a baseline to better understand the improvement offered by adopting our approach. The baseline is obtained using Basic Prompt, without Few-shot examples and RAG.


Table below presents the results of the comparison. We observe a significant improvement of 25\%pt and 18\%pt for XSS and SQLi respectively, when compared to the baseline. 
There is a slight decrease in F2 compared to SOTA models, with a 3.15\%pt and 0.83\%pt drop for XSS and SQLi, respectively. 
We argue that the slight performance gap between our approach and SOTA models is understandable, given our approach's training-free nature and direct applicability to multiple tasks. <!--These results provide empirical support for our claim that incorporating external knowledge and Self-Ranking is essential for LLMs to achieving competitive performance with SOTA models. -->

![screen](../tables_screenshot/rq3_f2.png)

## RQ4
Can the optimal parameters for
function and synthetic data generation in one task be
transferred and applied to achieve effective results in
other tasks?

### Transferability Accuracy
![screen](../tables_screenshot/rq4_ubest.png)

![screen](../tables_screenshot/rq4.png)



### Transferability F2-Score
![screen](../tables_screenshot/rq4_ubest_f2.png)

![screen](../tables_screenshot/rq4_f2.png)


